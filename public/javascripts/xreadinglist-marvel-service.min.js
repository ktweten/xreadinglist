function mapUrls(f){var m={reader:"Read on Marvel Unlimited",purchase:"Buy Digital Copy ",detail:"Details on Marvel"},c=[],h,b;for(b=0;b<f.length;b+=1)(h=m[f[b].type]||"")&&c.push({type:h,url:f[b].url});return 0<c.length?c:[{type:"Marvel.com",url:"http://www.marvel.com"}]}
angular.module("xReadingList").service("MarvelService",["$http",function(f){function m(b){return function(d,e,a,g){d.data&&d.data.results&&0<d.data.results.length&&(b.coverRoot=d.data.results[0].thumbnail.path,b.extension=d.data.results[0].thumbnail.extension,b.urls=mapUrls(d.data.results[0].urls))}}function c(b,d,e,a){var g=a+100,f={};for(a=0;a<e.length;a+=1)f[e[a].number]=a,e[a].coverRoot="";return function(a,c,k,l){if(a.data&&a.data.results)for(c=0;c<a.data.results.length;c+=1)if(k=a.data.results[c],
l=f[k.issueNumber.toString()])e[l].coverRoot=k.thumbnail.path,e[l].extension=k.thumbnail.extension,e[l].urls=mapUrls(k.urls);a.data.offset+a.data.count<a.data.total&&a.data.limit===a.data.count&&1E3>g&&h(b,d,g,e)}}function h(b,d,e,a){for(var g=0;g<a.length;g+=1)a[g].coverRoot="";f.get("http://gateway.marvel.com:80/v1/public/comics?title="+b+"&startYear="+d+"&formatType=comic&offset="+e+"&limit=100&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(c(b,d,a,e))}return{getMarvelData:function(b){f.get("http://gateway.marvel.com:80/v1/public/comics?title="+
b.series+"&startYear="+b.volume+"&issueNumber="+b.number+"&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(m(b))},getMarvelVolumeData:h}}]);
