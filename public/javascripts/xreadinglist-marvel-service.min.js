function mapUrls(b){var l={reader:"Read on Marvel Unlimited",purchase:"Buy Digital Copy ",detail:"Details on Marvel"},c=[],f,a;for(a=0;a<b.length;a+=1)(f=l[b[a].type]||"")&&c.push({type:f,url:b[a].url});return 0<c.length?c:[{type:"Marvel.com",url:"http://www.marvel.com"}]}
angular.module("xReadingList").service("MarvelService",["$http",function(b){function l(a){return function(d,e,b,g){d.data&&d.data.results&&0<d.data.results.length&&(a.coverRoot=d.data.results[0].thumbnail.path,a.extension=d.data.results[0].thumbnail.extension,a.urls=mapUrls(d.data.results[0].urls))}}function c(a,d,e,b){var g=b+100;return function(b,c,h,k){if(b.data&&b.data.results)for(c=0;c<b.data.results.length;c+=1)for(k=b.data.results[c],h=0;h<e.length;h+=1)if(e[h].number===k.issueNumber.toString()){e[h].coverRoot=
k.thumbnail.path;e[h].extension=k.thumbnail.extension;e[h].urls=mapUrls(k.urls);break}b.data.offset+b.data.count<b.data.total&&b.data.limit===b.data.count&&1E3>g&&f(a,d,g,e)}}function f(a,d,e,f){for(var g=0;g<f.length;g+=1)f[g].coverRoot="";b.get("http://gateway.marvel.com:80/v1/public/comics?title="+a+"&startYear="+d+"&formatType=comic&offset="+e+"&limit=100&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(c(a,d,f,e))}return{getMarvelData:function(a){b.get("http://gateway.marvel.com:80/v1/public/comics?title="+
a.series+"&startYear="+a.volume+"&issueNumber="+a.number+"&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(l(a))},getMarvelVolumeData:f}}]);
