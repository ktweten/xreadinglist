function mapUrls(b){var e={reader:"Read on Marvel Unlimited",purchase:"Buy Digital Copy ",detail:"Details on Marvel"},d=[],g,a;for(a=0;a<b.length;a+=1)(g=e[b[a].type]||"")&&d.push({type:g,url:b[a].url});return 0<d.length?d:[{type:"Marvel.com",url:"http://www.marvel.com"}]}
angular.module("xReadingList").service("MarvelService",["$http",function(b){function e(a){return function(c,f,b,d){c.data&&c.data.results&&0<c.data.results.length&&(a.coverRoot=c.data.results[0].thumbnail.path,a.extension=c.data.results[0].thumbnail.extension,a.urls=mapUrls(c.data.results[0].urls))}}function d(a,c,f,b){var d=b+100,e={};for(j=0;j<f.length;j+=1)e[f[j].number]=f[j];return function(b,h,k,l){if(b.data&&b.data.results)for(h=0;h<b.data.results.length;h+=1)if(k=b.data.results[h],l=e[k.issueNumber.toString()])l.coverRoot=
k.thumbnail.path,l.extension=k.thumbnail.extension,l.urls=mapUrls(k.urls);b.data.offset+b.data.count<b.data.total&&b.data.limit===b.data.count&&1E3>d&&g(a,c,d,f)}}function g(a,c,f,e){b.get("http://gateway.marvel.com:80/v1/public/comics?title="+a+"&startYear="+c+"&formatType=comic&offset="+f+"&limit=100&noVariants=true&orderBy=issueNumber&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(d(a,c,e,f))}return{getMarvelData:function(a){b.get("http://gateway.marvel.com:80/v1/public/comics?title="+
a.series+"&startYear="+a.volume+"&issueNumber="+a.number+"&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(e(a))},getMarvelVolumeData:g}}]);
