function mapUrls(d){var m={reader:"Read on Marvel Unlimited",purchase:"Buy Digital Copy ",detail:"Details on Marvel"},f=[],g,a;for(a=0;a<d.length;a+=1)(g=m[d[a].type]||"")&&f.push({type:g,url:d[a].url});return 0<f.length?f:[{type:"Marvel.com",url:"http://www.marvel.com"}]}
angular.module("xReadingList").service("MarvelService",["$http",function(d){function m(a){return function(c,e,b,d){c.data&&c.data.results&&0<c.data.results.length&&(a.coverRoot=c.data.results[0].thumbnail.path,a.extension=c.data.results[0].thumbnail.extension,a.urls=mapUrls(c.data.results[0].urls))}}function f(a,c,e,b){var d=b+100,f={};for(b=0;b<e.length;b+=1)f[e[b]]=b;return function(b,h,k,l){if(b.data&&b.data.results)for(h=0;h<b.data.results.length;h+=1)if(k=b.data.results[h],l=f[k.issueNumber.toString()])e[l].coverRoot=
k.thumbnail.path,e[l].extension=k.thumbnail.extension,e[l].urls=mapUrls(k.urls);b.data.offset+b.data.count<b.data.total&&b.data.limit===b.data.count&&1E3>d&&g(a,c,d,e)}}function g(a,c,e,b){d.get("http://gateway.marvel.com:80/v1/public/comics?title="+a+"&startYear="+c+"&formatType=comic&offset="+e+"&limit=100&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(f(a,c,b,e))}return{getMarvelData:function(a){d.get("http://gateway.marvel.com:80/v1/public/comics?title="+a.series+
"&startYear="+a.volume+"&issueNumber="+a.number+"&noVariants=true&apikey=2c7b5e832ec9ddc7c4dc4e432f24fbb4",{cache:!0}).success(m(a))},getMarvelVolumeData:g}}]);
