function issueSort(h,b){return isNaN(h.number)?1:isNaN(b.number)?-1:Number(h.number)-Number(b.number)}
angular.module("xReadingList").factory("Collection",["MarvelService",function(h){return{CreateCollection:function(){var b=this;b.comics=[];b.debug="?";b.clear=function(){b.comics=[]};b.getSeries=function(g){var a=null,c;for(c=0;c<b.comics.length;c+=1)if(b.comics[c].name===g){a=b.comics[c];break}a||(a={name:g,volumes:[],issues:[]},b.comics.push(a));return a};b.getIssues=function(b,a){var c=null,d;for(d=0;d<b.volumes.length;d+=1)if(b.volumes[d].name===a){c=b.volumes[d].issues;break}c||(c={name:a,issues:[],
selectedIssue:!1,expand:!1},b.volumes.push(c),c=c.issues);return c};b.addIssues=function(g){var a,c,d,e,f=[];for(c=0;c<g.length;c+=1){e=g[c];d=b.getSeries(e.series,b.comics);d=b.getIssues(d,e.volume);e.number||(e.number="Oneshot");for(a=0;a<d.length&&d[a].number!==e.number;a+=1);a===d.length?(e.coverRoot="http://i.annihil.us/u/prod/marvel/i/mg/b/40/image_not_available",e.extension="jpg",e.urls=[{type:"Marvel.com",url:"http://www.marvel.com"}],d.push(e),d.sort(issueSort)):(e.coverRoot=d[a].coverRoot,
e.extension=d[a].extension,e.urls=d[a].urls,d[a]=e);for(a=0;a<f.length&&(f[a].series!==e.series||f[a].volume!==e.volume);a+=1);a===f.length&&f.push({series:e.series,volume:e.volume,list:d})}for(a=0;a<f.length;a+=1)h.getMarvelVolumeData(f[a].series,f[a].volume,0,f[a].list)}}}}]);
